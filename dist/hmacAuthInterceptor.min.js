!function(){"use strict";angular.module("hmacAuthInterceptor",["hmacAuthInterceptorSigner"]).factory("hmacInterceptor",["hmacSigner",function(t){var e={host:"",whitelist:[],accessId:"",secretKey:"",headers:{contentType:"X_HMAC_CONTENT_TYPE",contentMD5:"X_HMAC_CONTENT_MD5",date:"X_HMAC_DATE",authorization:"X_HMAC_AUTHORIZATION"}},n=function(t,n){n="undefined"!=typeof n?n:!1;var c=n?e[headers][t]:e[t];return angular.isFunction(c)?c():c},c=function(t,n,c){c="undefined"!=typeof c?c:!1,c?e[headers][t]=n:e[t]=n},o=function(c){if(c.url.search(n("host"))>-1){for(var o=!1,r=[].concat(n("whitelist")),u=0;u<r.length;u++)if(c.url.search(r[u])>-1){o=!0;break}o||t.sign(c,n("accessId"),n("secretKey"),e.headers)}return c};return{set host(t){c("host",t)},get host(){n("host")},set whitelist(t){c("whitelist",t)},get whitelist(){n("whitelist")},set accessId(t){c("accessId",t)},get accessId(){n("accessId")},set secretKey(t){c("secretKey",t)},get secretKey(){n("secretKey")},headers:{set contentType(t){c("contentType",t,!0)},get contentType(){n("contentType",!0)},set contentMD5(t){c("contentMD5",t,!0)},get contentMD5(){n("contentMD5",!0)},set date(t){c("date",t,!0)},get date(){n("data",!0)},set authorization(t){c("authorization",t,!0)},get authorization(){n("authorization",!0)}},request:o}}]),angular.module("hmacAuthInterceptorSigner",[]).factory("hmacSigner",function(){var t=function(t,c,o,r){e(t,r),n(t,c,o,r)},e=function(t,e){b(t,e.contentType,u(t)),b(t,e.contentMD5,a(t)),b(t,e.date,r())},n=function(t,e,n,r){var u=o(t,r),i="APIAuth "+e+":"+c(u,n);b(t,r.authorization,i)},c=function(t,e){return CryptoJS.HmacSHA1(t,e).toString(CryptoJS.enc.Base64)},o=function(t,e){return[f(t,e.contentType),f(t,e.contentMD5),i(t),f(t,e.date)].join(",")},r=function(){return(new Date).toUTCString()},u=function(t){return f(t,"Content-Type")||""},i=function(t){return t.url.replace(/^(?:\/\/|[^\/]+)*/,"")},a=function(t){var e=s(t);return CryptoJS.MD5(e).toString(CryptoJS.enc.Base64)},s=function(t){var e=t.data;return angular.isObject(e)?angular.toJson(e):e||""},f=function(t,e){return t.headers[e]},b=function(t,e,n){t.headers[e]=n};return{sign:t}})}();